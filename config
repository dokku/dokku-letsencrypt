#!/usr/bin/env bash
set -eo pipefail
[[ $DOKKU_TRACE ]] && set -x

DOCKERFILE_PATH=$(dirname -- "$(readlink -f -- "$BASH_SOURCE")")/Dockerfile
export LETSENCRYPT_IMAGE=${LETSENCRYPT_IMAGE:="$(awk -F '[ :]' '{print $2}' "${DOCKERFILE_PATH}")"}
export LETSENCRYPT_IMAGE_VERSION=${LETSENCRYPT_IMAGE_VERSION:="$(awk -F '[ :]' '{print $3}' "${DOCKERFILE_PATH}")"}

export PLUGIN_DISABLE_PULL=${LETSENCRYPT_DISABLE_PULL:=}
export PLUGIN_DISABLE_PULL_VARIABLE="LETSENCRYPT_DISABLE_PULL"
export PLUGIN_IMAGE=$LETSENCRYPT_IMAGE
export PLUGIN_IMAGE_VERSION=$LETSENCRYPT_IMAGE_VERSION

export LETSENCRYPT_CRON_CMD="$PLUGIN_AVAILABLE_PATH/letsencrypt/cron-job"
export LETSENCRYPT_CRON_JOB="@daily $LETSENCRYPT_CRON_CMD"
